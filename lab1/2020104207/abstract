 程序员的自我修养笔记
第一章：
这一章主要讲解了基本计算机的软硬件结构，包括关键的硬件，处理器介绍，系统软件的基本内容和有关线程的知识。
计算机三个关键的硬件是：CPU、内存、I/O控制芯片。处理器分为对称多处理器和多核处理器，其中对称多处理器有多个地位相同的CPU，主要用于大型的数据库和服务器；多核处理器是多个处理器打包到一起，多核共用缓存，主要用于个人PC。
关于系统软件的接口，有应用程序编程接口API，是运行库提供的，给应用该程序/开发工具使用；系统调用接口是操作系统提供的，给运行库使用；硬件规格是硬件厂商提供的，给操作系统内使用。
操作系统的功能是一个提供抽象的接口和管理硬件资源。由于CPU运算能力的发展，操作系统由一开始的多道程序到分时系统监控，再到多任务系统。而同时对于IO的角度看，硬件被抽象成一定的概念，由驱动完成。
如何用有限的物理地址分配给更多的程序使用？一开始是直接分配地址，但是存在地址空间不隔离（程序不安全）、内存使用效率低、程序运行地址不确定等缺点。于是使用虚拟地址的方法，把程序所需的内存空间大小的虚拟空间映射到某个物理地址空间，这是分段的方法；把内存分为固定大小的页，在进行映射，这是分页的方法。
线程是程序运行流的最小单位，而多线程是因为避免长时间等待、长时间计算、程序本身要求的并发，并且多核计算机本身能力具备、多线程数据共享效率高。线程的访问权限由线程私有和线程间共享，根据不同的变量参数而选择不同的线程。由于线程数量有限，就会有调用优先级的问题：挡线程数量小于处理器数量时，采用真正并行状态；线程数量大于 处理器数量时候根据线程状态进行调度，调度方法可以使用户自行调度以及轮转发等。
第六章：
虚拟地址空间时程序运行时的独立空间，大小由平台决定，也可以通过c语音指针大小判断（32位是4字节，64位是8字节）。地址空间的分配分给操作系统时会有一些错误（“段错误或者进程因费偶发操作需关闭”，还可以分给进程使用，或者预留给其他的用途。物理地址扩展（PAE）是Intel改进CPU，发展36位地址线，可映射访问更多内存。
装载的原理是最常用部分主流在内存，其余放在磁盘中。装载分为覆盖装入方式（程序员需要手动复写以及调用，已被淘汰）和也映射方式。也映射方式属于虚拟存储一部分，是现代操作系统的存储管理器的做法，他将内存、磁盘所有数据与指令按照页为单位划分为若干个页。
从操作系统的角度看装载，是有可执行程序地址到进程虚拟地址，再到物理内存地址，进程的建立首先创建进程虚拟地址空间，建立映射；2读取可执行文件头，建立映射；3CPU指令寄存器设置为可执行文件入口；4操作系统通过可执行文件的头部信息建立起可执行文件和进程虚拟存储之间映射的关系。
进程的虚拟存储空间的分布，操作系统通过给进程空间划分出一个个VMA来管理进程的虚拟空间，原则上是将相同权限竖向的有相同影响文件的和映射成一个VMA。（操作系统只关心与装载相关的问题，为了节省内存，将相同权限的段合并在一起映射，成为“segment”一个segment对应一个VMA）。页是映射的最小单位，映射有长度和歧视地址的限制，对可执行文件应尽量优化空间和地址的安排。进程栈的初始化常见做法之一是操作系统在进程启动前将这些信息提前保存到进程的虚拟空间的栈中。
